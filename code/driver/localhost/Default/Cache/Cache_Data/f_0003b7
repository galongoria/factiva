"use strict";jQuery(document).ready(function(){(function(n,t,i){var r=window.djCore=window.djCore||{};String.prototype.contains||(String.prototype.contains=function(){return String.prototype.indexOf.apply(this,arguments)!==-1});String.prototype.startsWith=function(n){return n===this.substr(0,n.length)};String.prototype.ltrim=function(){return this.replace(/^\s+/g,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/g,"")};Date.prototype._pad=function(n){var t=String(n);return t.length===1&&(t="0"+t),t};Date.prototype.ToFactivaIsoString=function(){return this.getUTCFullYear()+this._pad(this.getUTCMonth()+1)+this._pad(this.getUTCDate())};r.Editor=function(){function w(t,r,o){var a=this,v,y;a._o=t;a.$editor=n("#"+t.id);a.$annotations=n("#"+t.annotations);a.$warning=n(".warning",a.$annotations);a.$counter=n(".counter",a.$annotations);a._o.originalHeight=a.$editor.height();a.events=u.mixin({},et,r);a.settings=u.mixin({},rt,t.settings);a.tokens=u.mixin({},ft,o);a.serviceOptions=u.mixin({},ut,t.serviceOptions);a.langTools=i.require("ace/ext/language_tools");a.editor=i.edit(t.id);a.editor.getSession().setMode(t.mode);a.editor.setOptions({enableLiveAutocompletion:!0,enableSnippets:!1,hScrollBarAlwaysVisible:!1});a.editor.setTheme(a._o.theme);a.editor.renderer.setShowGutter(a.settings.showGutter!==!1);a.editor.getSession().setUseWrapMode(a.settings.showWrapMode===!0);a._initEvents();a._enableEditorCommands();a._disableEditorCommands();a._initializeAutocomplete();a.editor.commands.on("afterExec",function(n){switch(n.command.name.toLowerCase()){case"insertoperator":a.showOperators=undefined;return;case"insertstring":n.args==="\n";return;case"insertsnippet":a.showOperators=!0;window.setTimeout(function(){a.editor.execCommand("startAutocomplete")},1);return;case"backspace":a.showOperators=undefined;return}return});v=window.parent&&window.parent.FactivaHeader?window.parent.FactivaHeader:FactivaHeader;e.url=v.settings.asCompanyServiceUrl;e.suggestToken=v.settings.asCompanySuggestToken;e.useNewServiceForCompany=v.settings.useNewServiceForCompany;y={getCompletions:function(i,r,e,o,v){var ft=e.row,et=e.column,b,d="keyWord",tt="keyWord",k,w=r.getTokenAt(ft,et),y,rt,ut,g;if(!w||w.type==="keyword.equals"){v(null,[]);return}if(w.type==="text"){if(y=a.getCategory(r,{row:e.row,column:w.start}),f(y),f(a.showOperators),a.showOperators){a.showOperators=undefined;b=w.value;rt=[].concat(s);v(null,rt);return}if(y.lparen===0&&y.operator>0&&y.text>0){v(null,s.concat(p).concat(l));return}if(!y.category&&y.lparen===0&&y.operator>=0&&y.text===0){v(null,s.concat(p).concat(l));return}if(y.category&&(y.category==="fds"||y.category==="co"||y.category==="duns"||y.category==="in"||y.category==="ns"||y.category==="re"||y.category==="rst"||y.category==="sc")||y.category==="au"){if(f(w.value),b=n.trim(w.value),d=y.category,tt=c[h[d]]||"Categories",k={id:t.id,url:a.settings.url,extraParams:a._setExtraParams(b,tt)},ut=/^[^/\\()~!@#$%^&*{«»„““”‘’|\n\t….,;`^"<>'}+:?®©].*/gi,!ut.test(b)){v(null,[]);return}g=nt[d];g&&(k.extraParams.match=g,k.extraParams=u.mixin(k.extraParams,g));a.fireRequest(b,tt,d,k,v);return}if(y.category&&y.category==="la"){v(null,it);return}}v(null,[]);return}};a.langTools.addCompleter(y);window.Worker||(f("non-web-worker implementation"),a._parse=a.parse,window.setInterval(u.bind(a.parser,a),1e3))}function b(t,i,r,u){if(i.matchCase||(t=t.toLowerCase()),typeof i.url=="string"&&i.url.length>0){var f={timestamp:+new Date};n.each(i.extraParams,function(n,t){f[n]=typeof t=="function"?t():t});f.autocompletionType=="Categories"&&i.extraParams.categories.toLowerCase().indexOf("symbol")>=0?(i.url=i.url+"/"+f.autocompletionType+"",n.when(k(i,f,i.id)).done(function(n,i){n.error!=undefined||(i!=null&&i.error==null&&n.category.push(i),r({term:t,data:n}))}).fail(function(){u({error:"Could not make jsonp call."})})):(i.url=i.url+"/"+f.autocompletionType+"",n.when(k(i,f,i.id)).done(function(n){r({term:t,data:n})}).fail(function(){u({error:"Could not make jsonp call."})}))}else u("unable to find items")}function k(t,i,r){var f=new n.Deferred,u,s,h,o;return i.autocompletionType=="Categories"&&(u=i.categories.split("|"),u=n.grep(u,function(n){return n}),s=n.inArray("symbol",u),s>=0&&u.splice(s,1),i.categories=u.join("|"),u.length==0)?(h={category:[],host:"",httpStatus:200,version:"1.0"},f.resolve(h)):(e.useNewServiceForCompany=="True"&&i.autocompletionType=="company"?(o=n.extend(!1,{},i),o.suggestContext=e.suggestToken,n.dj_jsonp({mode:"abort",cache:!1,port:"autocomplete"+r,dataType:t.dataType,callbackParameter:"callback",url:e.url+"/"+o.autocompletionType,data:o,success:function(n){f.resolve(n)},error:function(n){f.reject(n)}})):n.dj_jsonp({mode:"abort",cache:!1,port:"autocomplete"+r,dataType:t.dataType,callbackParameter:"callback",url:t.url,data:i,success:function(n){f.resolve(n)},error:function(n){f.reject(n)}}),f.promise())}function f(n){r.logger.debug(n)}function v(n,t){f({namspace:d,name:n,data:t})}var u=r.utils,d="djCore.Editor",h={fds:"company",duns:"company",co:"company","in":"industry",ns:"newssubject",sc:"source",sn:"source",rst:"source",au:"author",pe:"executive",re:"region_all"},o=n("#sbFTQSize").val();o<=0&&(o=2048);var g={fds:{match:"fcode",showViewAllPrivateMarkets:!1,dataSet:"newsCodedAbt",filterADR:!1},co:{match:"ticker",showViewAllPrivateMarkets:!1,dataSet:"newsCodedAbt",filterADR:!1},rst:{match:"code",status:"active",types:"1|2|3|4|5",includeSourceFamily:"true",includeGroups:!0},"in":{match:"code",status:"active"},ns:{match:"code",showViewAllPrivateMarkets:!1,status:"active"},sc:{match:"code",status:"active",types:"1|2|3|4|5",includeGroups:!1},sn:{match:"name",status:"active"},re:{match:"code",type:"all",status:"active"},pe:{match:"code",filterNewsCoded:!0,includeJobs:!1},au:{match:"code",activeOnly:!0}},nt={fds:{match:"fcode|name|alias",showViewAllPrivateMarkets:!1,dataSet:"newsCodedAbt",filterADR:!1},co:{match:"ticker|name|alias",showViewAllPrivateMarkets:!1,dataSet:"newsCodedAbt",filterADR:!1},duns:{match:"duns|name",showViewAllPrivateMarkets:!1,dataSet:"newsCodedAbt",filterADR:!1},rst:{match:"code|name|alias",types:"1|2|3|4|5",statuses:"active",includeSourceFamily:"true",includeGroups:!0},"in":{match:"code|name|alias",status:"active"},ns:{match:"code|name|alias",showViewAllPrivateMarkets:!1,status:"active"},sc:{match:"code|name|alias",status:"active",types:"1|2|3|4|5",includeGroups:!1},sn:{status:"active"},re:{match:"code|name|alias",type:"all",status:"active"},pe:{match:"code|name",filterNewsCoded:!0,includeJobs:!1},au:{match:"code|name",activeOnly:!0}},y={author:"author",outlet:"outlet",executive:"executiveLabel",company:"companyLabel",region:"regionLabel",publishercity:"publisherCity",publishermetadata:"publisherData",newssubject:"subjectLabel",industry:"industryLabel",industry_nace:"industryLabel",industry_sic:"industryLabel",industry_naics:"industryLabel",source:"sourcesLabel",keyword:"keyword",region_all:"regionLabel",region_country:"regionLabel",region_stateorprovince:"regionLabel",region_metropolitanarea:"regionLabel",region_subnationalregion:"regionLabel",region_supranationalregion:"regionLabel",region_subsupranationalregion:"regionLabel",calendarkeyword:"keyword",calendarcompany:"calendarCompany",symbol:"symbol",journalist:"author"},c={author:"journalist",outlet:"outlet",executive:"executive",company:"company",region:"region",publishercity:"publisherCity",publishermetadata:"publisherData",newssubject:"newsSubject",industry:"industry",industry_nace:"industry",industry_sic:"industry",industry_naics:"industry",source:"source",keyword:"keyWord",region_all:"region",region_country:"region",region_stateorprovince:"region",region_metropolitanarea:"region",region_subnationalregion:"region",region_supranationalregion:"region",region_subsupranationalregion:"region",calendarkeyword:"keyword",calendarcompany:"calendarCompany",symbol:"symbol"},tt={author:"journalists"},l=[{name:"after",value:"date after +|- x days",snippet:"date after -1",score:1,meta:window.translate("operator"),action:"insert"},{name:"before",value:"date before +|- x days",snippet:"date before +1",score:1,meta:window.translate("operator"),action:"insert"},{name:"from_to",value:"date from x day to y day ",snippet:"date from -1 to +1",score:1,meta:window.translate("operator"),action:"insert"},{name:"exact",value:"date exact",snippet:"date "+(new Date).ToFactivaIsoString(),score:1,meta:window.translate("operator"),action:"insert"},{name:"adjacency",value:"adj",snippet:"adj1",score:8,meta:window.translate("operator"),action:"insert"},{name:"same",value:"same",snippet:"same",score:8,meta:window.translate("operator"),action:"insert"},{name:"near",value:"near",snippet:"near1",score:8,meta:window.translate("operator"),action:"insert"},{name:"atleast",value:"atleast",snippet:"atleast1",score:8,meta:window.translate("operator"),action:"insert"},{name:"word count",value:"word count (wc)",snippet:"wc>1",score:8,meta:window.translate("operator"),action:"insert"}],s=[{name:"or",value:"or",snippet:"or ",score:10,type:"operator",meta:window.translate("operator"),action:"insert"},{name:"and",value:"and",snippet:"and ",score:10,type:"operator",meta:window.translate("operator"),action:"insert"},{name:"not",value:"not",snippet:"not ",score:10,type:"operator",meta:window.translate("operator"),action:"insert"}],p=[{name:window.translate("industryLabel"),value:window.translate("industryLabel")+" (in)",snippet:"in=",score:10,meta:window.translate("djii"),action:"insert"},{name:window.translate("subjectLabel"),value:window.translate("subjectLabel")+" (ns)",snippet:"ns=",score:10,meta:window.translate("djii"),action:"insert"},{name:window.translate("regionLabel"),value:window.translate("regionLabel")+" (re)",snippet:"re=",score:10,meta:window.translate("djii"),action:"insert"},{name:window.translate("companyTickerLabel"),value:window.translate("companyTickerLabel")+" (co)",snippet:"co=",score:10,meta:window.translate("djii"),action:"insert"},{name:window.translate("authorLabel"),value:window.translate("authorLabel")+" (au)",snippet:"au=",score:10,meta:window.translate("djii"),action:"insert"},{name:window.translate("companyLabel"),value:window.translate("companyLabel")+" (fds)",snippet:"fds=",score:10,meta:window.translate("djii"),action:"insert"},{name:window.translate("languageLabel"),value:window.translate("languageLabel")+" (la)",snippet:"la=",score:10,meta:window.translate("djii"),action:"insert"},{name:window.translate("sourcesLabel"),value:window.translate("sourcesLabel")+" (rst)",snippet:"rst=",score:10,meta:window.translate("djii"),action:"insert"}],it=[{name:window.translate("langAr"),value:window.translate("langAr"),snippet:"ar",score:1,meta:window.translate("language")},{name:window.translate("langBg"),value:window.translate("langBg"),snippet:"bg",score:1,meta:window.translate("language")},{name:window.translate("langCa"),value:window.translate("langCa"),snippet:"ca",score:1,meta:window.translate("language")},{name:window.translate("langCs"),value:window.translate("langCs"),snippet:"cs",score:1,meta:window.translate("language")},{name:window.translate("langDa"),value:window.translate("langDa"),snippet:"da",score:1,meta:window.translate("language")},{name:window.translate("langDe"),value:window.translate("langDe"),snippet:"de",score:1,meta:window.translate("language")},{name:window.translate("langEn"),value:window.translate("langEn"),snippet:"en",score:1,meta:window.translate("language")},{name:window.translate("langEs"),value:window.translate("langEs"),snippet:"es",score:1,meta:window.translate("language")},{name:window.translate("langFi"),value:window.translate("langFi"),snippet:"fi",score:1,meta:window.translate("language")},{name:window.translate("langFr"),value:window.translate("langFr"),snippet:"fr",score:1,meta:window.translate("language")},{name:window.translate("langHu"),value:window.translate("langHu"),snippet:"hu",score:1,meta:window.translate("language")},{name:window.translate("langId"),value:window.translate("langId"),snippet:"id",score:1,meta:window.translate("language")},{name:window.translate("langIt"),value:window.translate("langIt"),snippet:"It",score:1,meta:window.translate("language")},{name:window.translate("langJa"),value:window.translate("langJa"),snippet:"ja",score:1,meta:window.translate("language")},{name:window.translate("langKo"),value:window.translate("langKo"),snippet:"ko",score:1,meta:window.translate("language")},{name:window.translate("langMs"),value:window.translate("langMs"),snippet:"ms",score:1,meta:window.translate("language")},{name:window.translate("langNl"),value:window.translate("langNl"),snippet:"nl",score:1,meta:window.translate("language")},{name:window.translate("langNo"),value:window.translate("langNo"),snippet:"no",score:1,meta:window.translate("language")},{name:window.translate("langPl"),value:window.translate("langPl"),snippet:"pl",score:1,meta:window.translate("language")},{name:window.translate("langPt"),value:window.translate("langPt"),snippet:"pt",score:1,meta:window.translate("language")},{name:window.translate("langRu"),value:window.translate("langRu"),snippet:"ru",score:1,meta:window.translate("language")},{name:window.translate("langSk"),value:window.translate("langSk"),snippet:"sk",score:1,meta:window.translate("language")},{name:window.translate("langSv"),value:window.translate("langSv"),snippet:"sv",score:1,meta:window.translate("language")},{name:window.translate("langTh"),value:window.translate("langTh"),snippet:"th",score:1,meta:window.translate("language")},{name:window.translate("langTr"),value:window.translate("langTr"),snippet:"tr",score:1,meta:window.translate("language")},{name:window.translate("langVi"),value:window.translate("langVi"),snippet:"vi",score:1,meta:window.translate("language")},{name:window.translate("langZhcn"),value:window.translate("langZhcn"),snippet:"zhcn",score:1,meta:window.translate("language")},{name:window.translate("langZhtw"),value:window.translate("langZhtw"),snippet:"zhtw",score:1,meta:window.translate("language")},{name:window.translate("langRo"),value:window.translate("langRo"),snippet:"ro",score:1,meta:window.translate("language")},{name:window.translate("langEt"),value:window.translate("langEt"),snippet:"et",score:1,meta:window.translate("language")},{name:window.translate("langLt"),value:window.translate("langLt"),snippet:"lt",score:1,meta:window.translate("language")},{name:window.translate("langLv"),value:window.translate("langLv"),snippet:"lv",score:1,meta:window.translate("language")},],a={suggestContextObj:{callInitiated:!1,authToken:null}},rt={url:"//suggest.factiva.com/Search/1.0",symbolDataUrl:"//data.dowjones.com/autocomplete/data",dataType:"jsonp",authType:"SuggestContext",intercept:!1,interceptList:[{category:"source",prefix:"rst:"}],showGutter:!1,showWrapMode:!0},ut={maxResults:30,it:"stock",autocompletionType:"Categories",format:"json",interfaceLanguage:"en"},ft={},et={onChange:n.noop,onBlur:n.noop},e={url:"",suggestToken:"",useNewServiceForCompany:!1};return u.mixin(w.prototype,{__categoryMapper:function(n){return c[n]},parser:function(){var n=this,i,r=n.editor.getValue();try{i=n._parse(r)}catch(t){n.editor.getSession().setAnnotations([{message:t.message,name:t.name,count:t.count,type:"error"}]);return}n.editor.getSession().setAnnotations([{count:i,type:"data-count"}])},parse:function(){var n,t=0,i=function(t,i){throw{name:"SyntaxError",message:t,count:i,text:n};},u=function(n){return n&&n.length?n.length:0},r=function(n){for(var r,u=arguments.length>1?arguments[1]:"[",f=arguments.length>2?arguments[2]:"]",t=0,i=0;i<n.length;i++)if(r=n.charAt(i),r==u)t++;else if(r==f&&(t--,t<0))return!1;return t==0},f=function(n){return/^(?:[^"\\]|\\.|"(?:\\.|[^"\\])*")*$/.test(n)};return function(e){return(n=e,t=u(n),t>o)?i("reached-character-limit",t):r(n,"(",")")?r(n,"[","]")?f(n)?t:i("unbalanced-quotes",t):i("unbalanced-brackets",t):i("unbalanced-parens",countryRule)}}(),setTheme:function(n){var t=this;t.editor.setTheme(n)},fireRequest:function(n,t,i,r,u){var f=this;if(n&&n.length>0){b(n,r,function(e){if(t==="Categories")u(null,f._filter(r.extraParams.categories.split("|"),e,!1));else{var o=f._filterByCategory(t,i,e,n);o&&o.length>0?u(null,o):u(null,[])}},function(){u(null,s.concat(l))});return}},__snippetMapper:function(n,t,i){if(!i)switch(n.toLowerCase()){case"sn":return t.name;case"duns":return t.duns;case"co":return t.exchangeTicker||t.ticker;case"au":return t.nnid;case"keyword":return"";default:return t.code}switch(n.toLowerCase()){case"fds":case"company":return"fds="+t.code;case"ns":case"newssubject":return"ns="+t.code;case"re":case"region":return"re="+t.code;case"in":case"industry":return"in="+t.code;case"la":case"language":return"la="+t.code;case"sn":return"sn="+t.name;case"sc":case"rst":case"source":case"outlet":return"rst="+t.code;case"au":case"author":return"au="+t.nnid;case"pe":case"executive":return t.code?"pe="+t.code:'"'+t.name+'"';case"keyword":return'"'+t.name+'"';default:return'"'+t.name+'"'}},__scoreMapper:function(n){switch(n.toLowerCase()){case"company":return 10;case"newssubject":return 9;case"region":return 8;case"industry":return 7;case"language":return 6;case"source":case"outlet":return 5;case"executive":case"author":return 4;case"keyword":return 3;default:return 1}},_filter:function(i,r,u){var f=this,e=[],o,s=t.pick(r.data,"category").category;return n.each(i,function(i,r){var c,h,l;o=!1;r=f.__categoryMapper(r.toLowerCase());c=s[i];c&&(h=t.pick(c,r),h&&h[r]&&h[r].length&&h[r].length>0&&(l=h[r],n.each(l,function(n,t){t.name=t.value=t.value||t.descriptor||t.completeName||t.formalName||t.word;t.meta=window.translate(y[r.toLowerCase()]);t.score=f.__scoreMapper(r);t.snippet=f.__snippetMapper(r,t,u);t.name+=" ("+t.snippet+")";t.value=t.name;r!=="co"||t.exchangeTicker||t.ticker||(o=!0);o||e.push(t);e.push(t)})))}),e},_filterByCategory:function(i,r,u){var f=this,s=tt[h[r.toLowerCase()]]||i,e=t.pick(u.data,s)[s],c=[],o;return e&&e.length>0&&n.each(e,function(n,t){o=!1;t.name=t.value=t.value||t.descriptor||t.completeName||t.formalName||t.word;t.meta=window.translate(y[i.toLowerCase()]);t.score=f.__scoreMapper(i);i!=="keyWord"&&(t.snippet=f.__snippetMapper(r,t,!1));f._augmentName(t,i);t.value=t.name;r!=="co"||t.ticker||t.exchangeTicker||(o=!0);o||c.push(t)}),c},_retriveFirstItemByCategory:function(n,i,r,u){var e=t.pick(r.data,n)[n],f,o,s;if(e&&e.length>0)for(o=0,s=e.length;o<s;o++)if(f=e[o],f.code.toLowerCase()===u.toLowerCase()||f.exchangeTicker.toLowerCase()===u.toLowerCase())return f.controlType=n,f;return null},_augmentName:function(n,t){switch(t){case"keyWord":n.name+="";break;case"author":n.name+=" ("+n.outletName+")";break;default:n.name+=" ("+n.snippet+")"}},getInternetExplorerVersion:function(){var n=-1,t,i;return navigator.appName=="Microsoft Internet Explorer"&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i.exec(t)!=null&&(n=parseFloat(RegExp.$1))),n},isIE8:function(){var t=this,n=t.getInternetExplorerVersion();return n===-1?!1:n<=8?!0:!1},getCategory:function(n,t,i){var f=t.row,e=t.column,r=n.getTokenAt(f,e),u=i||{lparen:0,operator:0,text:0};if(r.start===0)return r.type==="keyword.fii"||r.type==="key.artcode"?(u.category=r.value,u):u;if(r){if(r.type==="paren.lparen"||r.type==="paren.lbracket"||r.type==="keyword.equals"||r.type==="keyword.operator"||r.type==="text"){if(u.immediate||(u.immediate=r.type),(r.type==="paren.lparen"||r.type==="paren.lbracket")&&u.lparen++,r.type==="keyword.operator"){if(u.lparen>0)return u;u.operator++}return r.type==="text"&&u.text++,this.getCategory(n,{row:t.row,column:r.start},u)}if(r.type==="keyword.fii"||r.type==="key.artcode")return u.category=r.value,u}return u},isOverlayVissble:function(){return n(".explainerjs-overlay").length!==0},_addOverlayLayer:function(){var t,i="",r=this,f;return r.isOverlayVissble()?!1:(f=n(document.body),t=n("<div />"),t.addClass("explainerjs-overlay"),i+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",t.attr("style",i),f.append(t),t.click(u.bind(r._stop,r)),setTimeout(function(){return i+="opacity: .8;opacity: .8;-ms-filter: 'progid:DXImageTransform.Microsoft.Alpha(Opacity=80)';filter: alpha(opacity=80);",t.attr("style",i)},10))},_stop:function(){var i=this,t=n(document.body);t.find(".explainerjs-overlay").fadeOut(function(){n(this).remove();i.focus()});t.find(".ee_g").remove()},_:function(){var t=this,r=t.editor.getValue(),i;return window.location.host==="global.factiva.com"||r!=="query gelinas"?!1:(this._addOverlayLayer(),i=n("<div />").addClass("ee_g"),i.click(u.bind(t._stop,t)),n(document.body).append(i),!0)},_controlReturn:function(n){n.commands.exec("insertstring",n,"\n")},_return:function(){var t=this;n.isFunction(t._o.returnHandler)&&t._o.returnHandler()},_enableEditorCommands:function(){var t=this,i=[{name:"ee",winKey:"Ctrl-Shift-G",macKey:"Ctrl-Shift-G",command:t._},{name:"controlReturn",winKey:"Ctrl-Return",macKey:"Ctrl-Return",command:t._controlReturn},{name:"return",winKey:"Return",macKey:"Return",command:t._return}];n.each(i,function(n,i){f(i.name);t.editor.commands.addCommands([{name:i.name,bindKey:{win:i.winKey,mac:i.macKey},exec:u.bind(i.command,t),readOnly:!0}])})},_disableEditorCommands:function(){var t=this;n.each([{name:"unfind",winKey:"Ctrl-F",macKey:"Command-F"},{name:"goToNextError",winKey:"Alt-E",macKey:"Ctrl-E"},{name:"goToPreviousError",winKey:"Alt-Shift-E",macKey:"Ctrl-Shift-E"},{name:"unfind_find_next",winKey:"Ctrl-K",macKey:"Command-K"},{name:"uncenter_selection",winKey:"Ctrl-L",macKey:"Command-L"},{name:"remove_settings",winKey:"Ctrl-,",macKey:"Command-,"}],function(n,i){f(i.name);t.editor.commands.addCommands([{name:i.name,bindKey:{win:i.winKey,mac:i.macKey},exec:function(){return!1},readOnly:!0}])})},_hasCompleter:function(){var n=this;return n.editor.completer&&n.editor.completer.activated},_detachCompleter:function(){var n=this,t=n._hasCompleter();t&&n.editor.completer.detach()},_initEvents:function(){var i=this;n(window).scroll(t.debounce(function(){i._detachCompleter()},250));i.editor.on("dblclick",function(t){var s=t.getDocumentPosition(),e=i.editor.session.getTokenAt(s.row,s.column),r,v;if(e&&e.type==="keyword.equals"&&(e=i.editor.session.getTokenAt(s.row,s.column+1)),e&&e.type==="text"&&(r=i.getCategory(i.editor.getSession(),{row:s.row,column:e.start}),r.category&&(r.category==="fds"||r.category==="co"||r.category==="in"||r.category==="ns"||r.category==="re"||r.category==="rst"||r.category==="au"||r.category==="sc"))){var f=n.trim(e.value),o=r.category,l=c[h[o]]||"Categories",a={id:i._o.id,url:i.settings.url,extraParams:i._setExtraParams(f,l)};if(/[/\\()~!@#$%^&*{«»„““”‘’|\n\t….,;`^"<>'}+:?®©]/gi.test(f))return;if(v=g[o],v&&(a.extraParams.match=v,a.extraParams=u.mixin(a.extraParams,v)),f&&f.length>0)switch(l){case"author":case"journalist":i._o.authorInfoClick(f,"","");break;default:b(f,a,function(n){var t;l=="company"?(t={code:f,value:"",controlType:"company"},o=="fds"&&(t.category="co"),o=="co"&&(t.category="ticker")):t=i._retriveFirstItemByCategory(l,o,n,f);t?i._o.infoClick(t):o.toLowerCase()==="rst"?RIND.getEntityDetails("",f,"sc",!0,!1):i._o.modalDialog({content:translate("invalidCode"),title:translate("invalid"),width:450,height:"auto"})},function(){})}}});i.editor.getSession().on("change",function(){i.events.onChange(i.editor.getValue().replace(/\s{2,}/g," "));i.updateHeight()});i.editor.getSession().on("tokenizerUpdate",function(n){v("tokenizerUpdate",n)});i.editor.on("blur",function(n){v("blur",n);i.events.onBlur(n)});i.editor.on("tokenizerUpdate",function(n){v("tokenizerUpdate",n)});i.editor.getSession().on("changeAnnotation",function(){var t,n;if(i.$annotations.length>0&&i.$warning.length>0&&i.$counter.length>0)if(t=i.editor.getSession().getAnnotations(),t&&t.length>0){n=t[0];switch(n.type){case"data-count":i.$annotations.removeClass("warning");i.$warning.html("&nbsp;");i.$counter.html(n.count+"/"+o);break;case"error":i.$annotations.addClass("warning");i.$counter.html(n.count+"/"+o);switch(n.message){case"reached-character-limit":i.$warning.html(window.translate("reachedCharacterLimit"));break;case"unbalanced-parens":i.$warning.html(window.translate("unbalancedParens"));break;case"unbalanced-quotes":i.$warning.html(window.translate("unbalancedQuotes"));break;case"unbalanced-brackets":i.$warning.html(window.translate("unbalancedBrackets"))}}}else i.$annotations.removeClass("warning"),i.$counter.html("&nbsp;"),i.$warning.html("&nbsp;")})},_initializeAutocomplete:function(){var t=this,f=t.settings,i=t.serviceOptions,r;f&&i&&(f.authType.toLowerCase()==="suggestcontext"&&(r=i.suggestContext),r===undefined||n.trim(r).length===0?a.suggestContextObj.callInitiated!==!0?t._getSuggestContextAndProcessRequest():a.suggestContextObj.authToken&&(i.suggestContext=u.urlDecode(a.suggestContextObj.authToken),t._finalizeInit()):(i.suggestContext=u.urlDecode(r),t._finalizeInit()))},_finalizeInit:function(){f("done --> initialization")},setHorizontalScrollBarOff:function(){var n=this;n.editor.renderer.setHScrollBarAlwaysVisible(!1)},focus:function(){var n=this,t=n.editor.getSession(),i=t.getLength();n.editor.gotoLine(i,t.getLine(i-1).length);window.setTimeout(function(){n.editor.focus()},1)},setValue:function(n,t){var i=this;i.editor.setValue(n,t||1)},getValue:function(){var n=this;return n.editor.getValue()},appendValue:function(t){var r=this,i=n.trim(r.editor.getValue());i&&i.length>0&&(i+=" ");i+=t;r.editor.setValue(i,1)},resize:function(){var n=this;n.editor.resize()},setHeight:function(n){var t=this;t.$editor.height(n+"px");t.editor.resize()},updateHeight:function(){var n=this,t=n.editor.getSession().getScreenLength()*n.editor.renderer.lineHeight+n.editor.renderer.scrollBar.getWidth();if(t!=n._o.originalHeight){if(t>n._o.originalHeight){n.$editor.height(t+"px");n.editor.resize();return}t<n._o.originalHeight&&(n.$editor.height(n._o.originalHeight),n.editor.resize())}},_setExtraParams:function(t,i){var r=this,u=r.settings,f=r.serviceOptions,e={format:"json",maxResults:10,autocompletionType:i||u.autocompletionType,searchText:t};return n.extend({},f,e)},_getSuggestContextAndProcessRequest:function(){var r=this,f=r.settings,i=r.serviceOptions,e=!1,t;if(f.url.indexOf("/Search/")>0){t=f.url.replace("/Search/","/Authenticate/");switch(f.authType.toLowerCase()){case"sessionid":n.trim(i.authToken).length>0&&(t=t+"/RegisterUsingSessionId?SID="+i.authToken,e=!0);break;case"encryptedtoken":n.trim(i.authToken).length>0&&(t=t+"/RegisterUsingEncryptedKey?eid="+i.authToken,e=!0)}e===!0&&n.dj_jsonp({url:t,callbackParameter:"callback",success:function(n){n.error||(i.suggestContext=u.urlDecode(n.key),r._finalizeInit())}})}}}),w}()})(jQuery,_,ace)});
